import{_ as k,C as d,c as o,o as t,a2 as h,b as r,j as e,w as a,a as i,G as l,a3 as p}from"./chunks/framework.CriqKoQt.js";const B=JSON.parse('{"title":"网络框架解析","description":"","frontmatter":{},"headers":[],"relativePath":"docs/2025上/pmd-network.md","filePath":"docs/2025上/pmd-network.md","lastUpdated":1766918923000}'),E={name:"docs/2025上/pmd-network.md"};function c(u,s,g,A,y,m){const n=d("Mermaid");return t(),o("div",null,[s[8]||(s[8]=h('<h1 id="网络框架解析" tabindex="-1">网络框架解析 <a class="header-anchor" href="#网络框架解析" aria-label="Permalink to &quot;网络框架解析&quot;">​</a></h1><h2 id="_1-基础层" tabindex="-1">1. 基础层 <a class="header-anchor" href="#_1-基础层" aria-label="Permalink to &quot;1. 基础层&quot;">​</a></h2><h3 id="_1-1-baserequest" tabindex="-1">1.1. BaseRequest <a class="header-anchor" href="#_1-1-baserequest" aria-label="Permalink to &quot;1.1. BaseRequest&quot;">​</a></h3><ul><li><code>BaseRequest</code> 是抽象类</li><li><code>send</code>，调用抽象方法 <code>doSend</code></li><li>私有 <code>interceptBeforeSend</code>、<code>interceptAfterResponse</code>、<code>interceptError</code></li><li>管理 <code>requestInterceptors</code>、<code>responseInterceptors</code>、<code>errorInterceptors</code></li></ul>',4)),(t(),r(p,null,{default:a(()=>[l(n,{id:"mermaid-31",class:"mermaid my-mermaid-class",graph:"graph%20LR%0Asend%0A%20%20subgraph%20send%0A%20%20interceptBeforeSend%20--%E8%B0%83%E7%94%A8%E6%8A%BD%E8%B1%A1%E6%96%B9%E6%B3%95--%3E%20doSend%5B%5BdoSend%5D%5D%20--%E5%A4%84%E7%90%86%E8%BF%94%E5%9B%9E--%3E%20interceptAfterResponse%20--%E5%8F%AF%E8%83%BD%E5%AD%98%E5%9C%A8--%3E%20interceptError%0A%0A%20%20subgraph%20interceptBeforeSend%0A%20%20%20%20customRequestInterceptorsHead%20-.-%3E%20requestInterceptors%20-.-%3E%20customRequestInterceptorsTail%0A%20%20end%0A%0A%20%20subgraph%20interceptAfterResponse%0A%20%20%20%20customResponseInterceptorsHead%20-.-%3E%20responseInterceptors%20-.-%3E%20customResponseInterceptorsTail%0A%20%20end%0A%0A%20%20subgraph%20interceptError%0A%20%20%20%20customErrorInterceptorsHead%20-.-%3E%20errorInterceptors%20-.-%3E%20customErrorInterceptorsTail%0A%20%20end%0Aend%0A"})]),fallback:a(()=>s[0]||(s[0]=[i(" Loading... ")])),_:1})),s[9]||(s[9]=h('<h3 id="_1-2-baserequestfactory" tabindex="-1">1.2. BaseRequestFactory <a class="header-anchor" href="#_1-2-baserequestfactory" aria-label="Permalink to &quot;1.2. BaseRequestFactory&quot;">​</a></h3><ul><li><code>BaseRequestFactory</code> 是抽象类</li><li>抽象方法 <code>create</code>，返回 <code>BaseRequest</code></li><li><code>create</code> 表示创建一个实例，用于一次执行请求发送</li></ul>',2)),(t(),r(p,null,{default:a(()=>[l(n,{id:"mermaid-52",class:"mermaid my-mermaid-class",graph:"graph%20LR%0A%0Acreate%5B%5Bcreate%5D%5D%0A%0Asubgraph%20names%5B%E5%B1%9E%E6%80%A7%5D%0A%20requestInterceptors%0A%20responseInterceptors%0A%20errorInterceptors%0Aend%0A%0A"})]),fallback:a(()=>s[1]||(s[1]=[i(" Loading... ")])),_:1})),s[10]||(s[10]=e("h3",{id:"_1-3-mprequest",tabindex:"-1"},[i("1.3. MpRequest "),e("a",{class:"header-anchor",href:"#_1-3-mprequest","aria-label":'Permalink to "1.3. MpRequest"'},"​")],-1)),s[11]||(s[11]=e("ul",null,[e("li",null,[i("继承自 "),e("code",null,"BaseRequest")]),e("li",null,[i("实现 "),e("code",null,"doSend")])],-1)),(t(),r(p,null,{default:a(()=>[l(n,{id:"mermaid-68",class:"mermaid my-mermaid-class",graph:"graph%20LR%0AWebRequest%20--%E7%BB%A7%E6%89%BF--%3E%20BaseRequest%0AMpRequest%20--%E7%BB%A7%E6%89%BF--%3E%20BaseRequest%0A%0Asubgraph%20WebRequest%0A%20%20doSendInWeb%5BdoSend%5D%20--%3E%20axios%0Aend%0A%0Asubgraph%20MpRequest%0A%20%20doSendInMp%5BdoSend%5D%20--%3E%20uni.request%0Aend%0A%0Asubgraph%20BaseRequest%0A%20%20doSendInBase%5BdoSend%5D%0Aend%0A"})]),fallback:a(()=>s[2]||(s[2]=[i(" Loading... ")])),_:1})),s[12]||(s[12]=e("h3",{id:"_1-4-mprequestfactory",tabindex:"-1"},[i("1.4. MpRequestFactory "),e("a",{class:"header-anchor",href:"#_1-4-mprequestfactory","aria-label":'Permalink to "1.4. MpRequestFactory"'},"​")],-1)),s[13]||(s[13]=e("ul",null,[e("li",null,[i("继承自 "),e("code",null,"BaseRequestFactory")]),e("li",null,[e("code",null,"create"),i(" 方法返回 "),e("code",null,"new MpRequest()")])],-1)),(t(),r(p,null,{default:a(()=>[l(n,{id:"mermaid-84",class:"mermaid my-mermaid-class",graph:"graph%20LR%0AWebRequestFactory%20--%E7%BB%A7%E6%89%BF--%3E%20BaseRequestFactory%0AMpRequestFactory%20--%E7%BB%A7%E6%89%BF--%3E%20BaseRequestFactory%0A%0Asubgraph%20WebRequestFactory%0A%20%20createInWeb%5Bcreate%5D%20--%E4%BC%A0%E9%80%92%E6%8B%A6%E6%88%AA%E5%99%A8--%3E%20WebRequest%5B%22new%20WebRequest(%7B...%7D)%22%5D%0Aend%0A%0Asubgraph%20MpRequestFactory%0A%20%20createInMp%5Bcreate%5D%20--%E4%BC%A0%E9%80%92%E6%8B%A6%E6%88%AA%E5%99%A8--%3E%20mpRequest%5B%22new%20MpRequest(%7B...%7D)%22%5D%0Aend%0A%0Asubgraph%20BaseRequestFactory%0A%20%20createInBase%5Bcreate%5D%0Aend%0A"})]),fallback:a(()=>s[3]||(s[3]=[i(" Loading... ")])),_:1})),s[14]||(s[14]=h(`<h3 id="_1-5-networkmanager" tabindex="-1">1.5. NetworkManager <a class="header-anchor" href="#_1-5-networkmanager" aria-label="Permalink to &quot;1.5. NetworkManager&quot;">​</a></h3><ul><li>是一个单例模式的网络请求管理器，提供统一的网络请求入口和拦截器机制</li><li>核心方法包括 <strong><code>setRequestFactory</code>、<code>setDecorator</code>、<code>request</code></strong></li></ul><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">public </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setRequestFactory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(factory: BaseRequestFactory) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.requestFactory </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> factory;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li><code>request(param)</code> 即 <code>NetworkManager.instance.request(param)</code></li></ul><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">public </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(param: IBaseRequestParam): </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Promise</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">any</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  const request </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.requestFactory.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">create</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(param);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (this.requestDecorator) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">requestDecorator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> request.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">send</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(param, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.customInterceptor), param);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  return request.send(param, this.customInterceptor);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div>`,5)),(t(),r(p,null,{default:a(()=>[l(n,{id:"mermaid-109",class:"mermaid my-mermaid-class",graph:"graph%20LR%0Asubgraph%20request%0ArequestFactoryCreate%5B%22requestFactory.create()%22%5D%20--request--%3E%20requestDecorator%20--%3E%20send%5B%22request.send%22%5D%0Aend%0A"})]),fallback:a(()=>s[4]||(s[4]=[i(" Loading... ")])),_:1})),s[15]||(s[15]=h(`<h3 id="_1-6-post" tabindex="-1">1.6. post <a class="header-anchor" href="#_1-6-post" aria-label="Permalink to &quot;1.6. post&quot;">​</a></h3><p>就是调用 <code>NetworkManager</code> 实例的 <code>request</code> 方法</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">param</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> IBaseRequestParam</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> NetworkManager.instance.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(param);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> post</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> request;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> get</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> request;</span></span></code></pre></div>`,3)),(t(),r(p,null,{default:a(()=>[l(n,{id:"mermaid-117",class:"mermaid my-mermaid-class",graph:"graph%20LR%0Apost%20--%3E%20requestInManager%5B%22instance.request%22%5D%0A"})]),fallback:a(()=>s[5]||(s[5]=[i(" Loading... ")])),_:1})),s[16]||(s[16]=h(`<h2 id="_2-业务层" tabindex="-1">2. 业务层 <a class="header-anchor" href="#_2-业务层" aria-label="Permalink to &quot;2. 业务层&quot;">​</a></h2><h3 id="_2-1-示例" tabindex="-1">2.1. 示例 <a class="header-anchor" href="#_2-1-示例" aria-label="Permalink to &quot;2.1. 示例&quot;">​</a></h3><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> factory</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MpRequestFactory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">factory.requestInterceptors </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;xxx&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">factory.responseInterceptors </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;xxx&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">factory.errorInterceptors </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;xxx&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NetworkManager.instance.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setRequestFactory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(factory);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NetworkManager.instance.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setDecorator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(mpCodeScheduler);</span></span></code></pre></div>`,3)),(t(),r(p,null,{default:a(()=>[l(n,{id:"mermaid-125",class:"mermaid my-mermaid-class",graph:"graph%20LR%0AinitNetworkManager%20--%22index-web%22--%3E%20initNetworkManagerInWeb%5BinitNetworkManager%5D%0AinitNetworkManager%20--%22index-mp%22--%3E%20initNetworkManagerInMp%5BinitNetworkManager%5D%0A%0Asubgraph%20initNetworkManagerInWeb%0AnewWebRequestFactory%5B%22new%20MpRequestFactory()%22%5D%20--%E8%AE%BE%E7%BD%AE%E5%A4%9A%E7%A7%8D%E6%8B%A6%E6%88%AA%E5%99%A8--%3E%20interceptors%20--%3E%20setRequestFactory%5B%22setRequestFactory(factory)%22%5D%20--%3E%20setDecorator%0Aend%0A%0Asubgraph%20initNetworkManagerInMp%0A%0Aend%0A"})]),fallback:a(()=>s[6]||(s[6]=[i(" Loading... ")])),_:1})),s[17]||(s[17]=e("h2",{id:"_3-总览",tabindex:"-1"},[i("3. 总览 "),e("a",{class:"header-anchor",href:"#_3-总览","aria-label":'Permalink to "3. 总览"'},"​")],-1)),s[18]||(s[18]=e("p",null,"所有类（方法）的总览视图",-1)),(t(),r(p,null,{default:a(()=>[l(n,{id:"mermaid-132",class:"mermaid my-mermaid-class",graph:"graph%20LR%0Abusiness%5B%E4%B8%9A%E5%8A%A1%5D%20--%3E%20post%0Abusiness%20--%3E%20initNetworkManager%0A%0AinitNetworkManager%20-.-%3E%20WebRequestFactory%0AinitNetworkManager%20-.-%3E%20MpRequestFactory%0AinitNetworkManager%20-.-%3E%20AppRequestFactory%0AinitNetworkManager%20--%3E%20NetworkManager%0A%0AWebRequestFactory%20--%3E%20BaseRequestFactory%5B%5BBaseRequestFactory%5D%5D%0AWebRequestFactory%20--%3E%20WebRequest%0A%0AWebRequest%20--%3E%20BaseRequest%5B%5BBaseRequest%5D%5D%0A"})]),fallback:a(()=>s[7]||(s[7]=[i(" Loading... ")])),_:1}))])}const q=k(E,[["render",c]]);export{B as __pageData,q as default};
