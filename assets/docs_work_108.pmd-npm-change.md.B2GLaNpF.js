import{_ as r,C as h,c as k,o as e,a2 as p,b as n,j as a,w as i,a as t,G as o,a3 as d}from"./chunks/framework.CriqKoQt.js";const F=JSON.parse('{"title":"PMD NPM 优化","description":"","frontmatter":{},"headers":[],"relativePath":"docs/work/108.pmd-npm-change.md","filePath":"docs/work/108.pmd-npm-change.md","lastUpdated":1768035829000}'),E={name:"docs/work/108.pmd-npm-change.md"};function A(g,s,c,m,u,y){const l=h("Mermaid");return e(),k("div",null,[s[9]||(s[9]=p('<div class="info custom-block"><p class="custom-block-title">作者</p><p>novlan1</p><p>2025.12.8</p></div><h1 id="pmd-npm-优化" tabindex="-1">PMD NPM 优化 <a class="header-anchor" href="#pmd-npm-优化" aria-label="Permalink to &quot;PMD NPM 优化&quot;">​</a></h1><h2 id="_1-旧的依赖关系" tabindex="-1">1. 旧的依赖关系 <a class="header-anchor" href="#_1-旧的依赖关系" aria-label="Permalink to &quot;1. 旧的依赖关系&quot;">​</a></h2><p>当前的依赖关系（2025.12.5）。</p>',4)),(e(),n(d,null,{default:i(()=>[o(l,{id:"mermaid-17",class:"mermaid my-mermaid-class",graph:"graph%20TD%0A%20%20widget%20--%3E%20tools%0A%20%20widget%20--%3E%20network%0A%20%20widget%20--%3E%20aegis%0A%0A%20%20vue%20--%3E%20report%0A%20%20vue%20--%3E%20tools%0A%20%20vue%20--%3E%20config%0A%20%20vue%20--%3E%20aegis%0A%20%20vue%20--%3E%20types%0A%20%20vue%20--%3E%20location%0A%20%20vue%20--%3E%20widget%0A%20%20vue%20--%3E%20network%0A%20%20vue%20--%3E%20login%0A%0A%20%20use%20--%3E%20tools%0A%20%20use%20--%3E%20widget%0A%0A%20%20tools%20--%20%E5%8F%8D%E5%90%91%20--%3E%20network%0A%20%20tools%20--%3E%20types%0A%20%20tools%20--%20%E5%8F%8D%E5%90%91%20--%3E%20vue%0A%0A%20%20report%20--%3E%20tools%0A%20%20report%20--%3E%20types%0A%20%20report%20--%3E%20config%0A%20%20report%20--%3E%20network%0A%0A%20%20pixui%20--%3E%20network%0A%20%20pixui%20--%3E%20config%0A%0A%20%20network%20--%3E%20types%0A%0A%20%20netbar%20--%3E%20tools%0A%0A%20%20login%20--%3E%20tools%0A%20%20login%20--%3E%20widget%0A%20%20login%20--%3E%20report%0A%20%20login%20--%3E%20types%0A%20%20login%20--%3E%20config%0A%20%20login%20--%3E%20network%0A%0A%20%20location%20--%3E%20widget%0A%20%20location%20--%3E%20tools%0A%20%20location%20--%3E%20network%0A%0A%20%20jsapi%20--%3E%20types%0A%20%20jsapi%20--%3E%20tools%0A%0A%20%20config%20--%3E%20types%0A%0A%20%20aegis%20--%3E%20tools%0A%0A%20%20abtest%20--%3E%20types%0A%20%20abtest%20--%3E%20network%0A%20%20abtest%20--%3E%20aegis%0A"})]),fallback:i(()=>s[0]||(s[0]=[t(" Loading... ")])),_:1})),s[10]||(s[10]=a("p",null,"上面有两个反向依赖。",-1)),s[11]||(s[11]=a("img",{src:"https://mike-1255355338.cos.ap-guangzhou.myqcloud.com/article/2025/12/own_mike_DpAcihdWT3cTZr6z.png",width:"500"},null,-1)),s[12]||(s[12]=a("p",null,[t("去掉上面的反向依赖后，相对清晰一点（至少上下级关系明确了，"),a("code",null,"vue"),t(" 在最上层，"),a("code",null,"types/tools"),t(" 在下层）。")],-1)),(e(),n(d,null,{default:i(()=>[o(l,{id:"mermaid-25",class:"mermaid my-mermaid-class",graph:"graph%20TD%0A%20%20widget%20--%3E%20tools%0A%20%20widget%20--%3E%20network%0A%20%20widget%20--%3E%20aegis%0A%0A%20%20vue%20--%3E%20report%0A%20%20vue%20--%3E%20tools%0A%20%20vue%20--%3E%20config%0A%20%20vue%20--%3E%20aegis%0A%20%20vue%20--%3E%20types%0A%20%20vue%20--%3E%20location%0A%20%20vue%20--%3E%20widget%0A%20%20vue%20--%3E%20network%0A%20%20vue%20--%3E%20login%0A%0A%20%20use%20--%3E%20tools%0A%20%20use%20--%3E%20widget%0A%0A%20%20tools%20--%3E%20types%0A%0A%20%20report%20--%3E%20tools%0A%20%20report%20--%3E%20types%0A%20%20report%20--%3E%20config%0A%20%20report%20--%3E%20network%0A%0A%20%20pixui%20--%3E%20network%0A%20%20pixui%20--%3E%20config%0A%0A%20%20network%20--%3E%20types%0A%0A%20%20netbar%20--%3E%20tools%0A%0A%20%20login%20--%3E%20tools%0A%20%20login%20--%3E%20widget%0A%20%20login%20--%3E%20report%0A%20%20login%20--%3E%20types%0A%20%20login%20--%3E%20config%0A%20%20login%20--%3E%20network%0A%0A%20%20location%20--%3E%20widget%0A%20%20location%20--%3E%20tools%0A%20%20location%20--%3E%20network%0A%0A%20%20jsapi%20--%3E%20types%0A%20%20jsapi%20--%3E%20tools%0A%0A%20%20config%20--%3E%20types%0A%0A%20%20aegis%20--%3E%20tools%0A%0A%20%20abtest%20--%3E%20types%0A%20%20abtest%20--%3E%20network%0A%20%20abtest%20--%3E%20aegis%0A"})]),fallback:i(()=>s[1]||(s[1]=[t(" Loading... ")])),_:1})),s[13]||(s[13]=a("p",null,[t("但还是不够清晰。更重要的是"),a("strong",null,"易变的和不变的还是没有分开"),t("。")],-1)),s[14]||(s[14]=a("p",null,"目标依赖关系：",-1)),(e(),n(d,null,{default:i(()=>[o(l,{id:"mermaid-32",class:"mermaid my-mermaid-class",graph:"graph%20TD%0A%20%20business%20--%3E%20baseSub%0A%20%20business%20--%3E%20middleSub%0A%0A%20%20middleSub%20--%3E%20baseSub%0A%0A%20%20subgraph%20baseSub%5B%20%5D%0A%20%20%20%20direction%20LR%0A%20%20%20%20network%20-.-%20config%0A%20%20%20%20config%20-.-%20tools%0A%20%20end%0A%0A%20%20subgraph%20middleSub%5B%20%5D%0A%20%20%20%20direction%20LR%0A%20%20%20%20jsapi%20-.-%20use%0A%20%20%20%20use%20-.-%20location%0A%20%20%20%20location%20-.-%20report%0A%20%20%20%20report%20-.-%20login%0A%20%20%20%20login%20-.-%20pixui%0A%20%20%20%20pixui%20%20-.-%20abtest%0A%20%20end%0A%0A%20%20linkStyle%203%2C4%2C5%2C6%2C7%2C8%2C9%2C10%20stroke-width%3A0px%0A"})]),fallback:i(()=>s[2]||(s[2]=[t(" Loading... ")])),_:1})),s[15]||(s[15]=a("p",null,"模板内部的依赖关系：",-1)),(e(),n(d,null,{default:i(()=>[o(l,{id:"mermaid-36",class:"mermaid my-mermaid-class",graph:"graph%20TD%0A%20%20business%20--%3E%20location%0A%20%20business%20--%3E%20network%0A%20%20business%20--%3E%20report%0A%20%20business%20--%3E%20config%0A%20%20business%20--%3E%20login%0A%20%20business%20--%3E%20tools%0A%0A%20%20login%20--%3E%20network%0A%20%20login%20--%3E%20tools%0A%20%20login%20--%3E%20config%0A%0A%20%20location%20--%3E%20network%0A%20%20location%20--%3E%20config%0A%20%20location%20--%3E%20tools%0A%0A%20%20report%20--%3E%20network%0A%20%20report%20--%3E%20config%0A%20%20report%20--%3E%20tools%0A%0A%20%20pixui%20--%3E%20tools%0A%0A%20%20abtest%20--%3E%20tools%0A%20%20abtest%20--%3E%20network%0A%0A%0A%20%20subgraph%20base%5B%20%5D%0A%20%20%20%20network%20--%3E%20config%0A%20%20%20%20config%0A%20%20%20%20tools%0A%20%20end%0A%0A%20%20subgraph%20middle%5B%20%5D%0A%20%20%20%20jsapi%20--%3E%20tools%0A%20%20%20%20use%20--%3E%20tools%0A%20%20%20%20location%0A%20%20%20%20report%0A%20%20%20%20login%0A%20%20%20%20abtest%0A%20%20%20%20pixui%0A%20%20end%0A"})]),fallback:i(()=>s[3]||(s[3]=[t(" Loading... ")])),_:1})),s[16]||(s[16]=p('<ol><li><code>types</code> 去掉，移动到对应的子包内</li><li><code>widget</code> 去掉，业务无关放到 <code>press-plus</code>，业务相关放到 <code>business</code></li><li><code>report</code> 和 <code>ageis</code> 合并</li><li><code>app-info</code> 去掉</li><li><code>use</code> 放业务无关的钩子，业务相关的放到 <code>business</code></li></ol><p>物理存储</p><ol><li><s><code>config/network</code> 拿走，放到 <code>plugin-light</code></s></li><li><s>参考模块变更频率，将 <code>tools</code> 中稳定的放到 <code>plugin-light</code>，易变的继续放到 <code>pmd-npm</code></s></li><li><s><code>location/business</code> 等不动</s></li></ol><h2 id="_2-核心思想" tabindex="-1">2. 核心思想 <a class="header-anchor" href="#_2-核心思想" aria-label="Permalink to &quot;2. 核心思想&quot;">​</a></h2><ol><li>依赖分层，避免蜘蛛网，更不允许反向依赖。维护者自己都搞不清楚，新人、使用者怎么能搞清楚？</li><li>分层，将底层的、稳定的、复用率高的拿走，中间层该合并的合并，该去掉的去掉。</li><li>用数据说话，将不变的和变化的分开</li><li>以下几种数据统计，需综合来看 <ol><li>依赖关系</li><li>变更频率</li><li>引用次数</li></ol></li></ol><h2 id="_3-参考资料" tabindex="-1">3. 参考资料 <a class="header-anchor" href="#_3-参考资料" aria-label="Permalink to &quot;3. 参考资料&quot;">​</a></h2><ul><li><a href="https://mobile.woa.com/plugin-light/CONTRIBUTING.html#_3-2-%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB" target="_blank" rel="noreferrer">Plugin Light 依赖关系</a></li><li><a href="https://mobile.woa.com/next-admin/change-statistics" target="_blank" rel="noreferrer">变更统计</a></li><li><a href="https://mobile.woa.com/next-admin/component-statistics" target="_blank" rel="noreferrer">使用统计</a></li></ul><hr><p>2025.12.11 更新</p><hr><h2 id="_4-独立发布" tabindex="-1">4. 独立发布 <a class="header-anchor" href="#_4-独立发布" aria-label="Permalink to &quot;4. 独立发布&quot;">​</a></h2><p>每个包独立版本，也不影响任何东西。因为业务从来都是 <code>pnpm i pmd-a@latest pmd-b@latest</code>，没真正关心过具体的版本号。</p><p>另外 <code>pmd</code> 包的 <code>dependencies</code> 也没声明过其他 <code>pmd</code> 子包，说明子包内部不关心其他包的版本，只关心其他包的内容。所以升级一个内容没改变的包的版本号并没有什么好处。</p><p>本质上，不管是我们自己的业务还是其他业务，<code>pmd</code> 提供的都是一个整体服务，尽管为了方便维护将他们分成了多包。</p>',14)),(e(),n(d,null,{default:i(()=>[o(l,{id:"mermaid-163",class:"mermaid my-mermaid-class",graph:"graph%20TD%0A%20%20business%5B%E4%B8%9A%E5%8A%A1%5D%20--%3E%20pmd%5Bpmd%5D%0A%0A%20%20subgraph%20pmd%5Bpmd%5D%0A%20%20%20%20pmd-a%20-.-%20pmd-b%20-.-%20...%0A%20%20end%0A%0A%20%20linkStyle%201%2C2%20stroke-width%3A0px%0A"})]),fallback:i(()=>s[4]||(s[4]=[t(" Loading... ")])),_:1})),s[17]||(s[17]=p(`<p>这一点和 <code>Press UI、Press Plus、Plugin Light</code> 中的子包是不一样的，这些是真正意义的独立子包，<code>pmd</code> 为了方便业务使用，做了权衡。</p><h2 id="_5-pnpm" tabindex="-1">5. pnpm <a class="header-anchor" href="#_5-pnpm" aria-label="Permalink to &quot;5. pnpm&quot;">​</a></h2><p>yarn 改 pnpm，发布流水线改造</p><ul><li>每个包独立发布</li><li>支持审核人</li><li>支持发布 <code>alpha/beta/patch</code> 版本</li><li>发布成功消息提醒，<code>alpha/beta</code> 同样支持</li></ul><p>之前的发布就只能指定一个分支：</p><img src="https://image-1251917893.file.myqcloud.com/next-svr/images/2025/12/own_mike_RWxc67B4HB7HsrED.png" width="500"><p>现在可以指定：</p><ul><li>分支</li><li>版本类型</li><li>发布子包</li><li>发布原因</li></ul><img src="https://image-1251917893.file.myqcloud.com/next-svr/images/2025/12/own_mike_RdSJXhfEizGEjp4F.png" width="500"><h2 id="_6-pmd-widget-改造" tabindex="-1">6. pmd-widget 改造 <a class="header-anchor" href="#_6-pmd-widget-改造" aria-label="Permalink to &quot;6. pmd-widget 改造&quot;">​</a></h2><p>业务无关的组件放到 press-plus 中，业务相关的放到 business 中。</p><p>Press Plus 有完善的文档、示例，为啥要放到 pmd 中？</p><h3 id="_6-1-总览" tabindex="-1">6.1. 总览 <a class="header-anchor" href="#_6-1-总览" aria-label="Permalink to &quot;6.1. 总览&quot;">​</a></h3><table tabindex="0"><thead><tr><th>序号</th><th>包</th><th>变更</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>1</td><td>toast</td><td>放到 <code>press-plus</code> 中</td><td>TS</td><td><code>pmd</code> 已做转发</td></tr><tr><td>2</td><td>dialog</td><td>放到 <code>press-plus</code> 中</td><td>TS</td><td><code>pmd</code> 已做转发</td></tr><tr><td>3</td><td>copy</td><td>放到 <code>press-plus</code> 中</td><td>TS</td><td><code>pmd</code> 已做转发</td></tr><tr><td>4</td><td>clipboard</td><td>放到 <code>press-plus</code> 中</td><td>Vue</td><td>只有<code>match-igame-admin</code>一个业务引用；<br>新业务建议直接使用copy方法，而不是组件；<br><code>pmd</code> 不处理，不再维护</td></tr><tr><td>5</td><td>marquee</td><td>放到 <code>press-plus</code> 中</td><td>Vue</td><td>新业务直接使用 <code>press-plus</code> 中的组件；<br><code>pmd</code> 不处理，不再维护</td></tr><tr><td>6</td><td>image-generator</td><td>放到 <code>press-plus</code> 中</td><td>Vue</td><td>同 <code>marquee</code></td></tr><tr><td>7</td><td>pag-animator</td><td>放到 <code>press-plus</code> 中</td><td>Vue</td><td>同 <code>marquee</code></td></tr><tr><td>8</td><td>qrcode</td><td>放到 <code>press-plus</code> 中</td><td>Vue</td><td>新业务直接使用 <code>press-ui</code> 中的组件；<br><code>pmd</code> 不处理，不再维护</td></tr><tr><td>9</td><td>video-player</td><td>放到 <code>press-plus</code> 中</td><td>Vue</td><td>同 <code>marquee</code></td></tr><tr><td>10</td><td>not-found</td><td>废弃</td><td>Vue</td><td>没一个业务使用；写的也很差</td></tr><tr><td>11</td><td>login</td><td>放到 <code>business</code> 中</td><td>Vue</td><td>-</td></tr><tr><td>12</td><td>share</td><td>放到 <code>business</code> 中</td><td>TS</td><td>-</td></tr><tr><td>13</td><td>share-v2</td><td>放到 <code>business</code> 中</td><td>TS</td><td>-</td></tr><tr><td>14</td><td>test-whitelist</td><td>放到 <code>business</code> 中</td><td>Vue</td><td>-</td></tr></tbody></table><h3 id="_6-2-toast" tabindex="-1">6.2. Toast <a class="header-anchor" href="#_6-2-toast" aria-label="Permalink to &quot;6.2. Toast&quot;">​</a></h3><p>之前的 <code>Toast</code> 放到了 <code>press-plus</code> 中，并在 <code>press-next</code> 放置了一个转发。你可以这样使用：</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { Toast } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@tencent/press-plus/common/toast&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 或者</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// import { Toast } from &#39;@tencent/press-next/common/toast&#39;;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Toast.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">show</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;hello guowangyang&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><p>同时，增加了类型提示和注释，对比如下。</p><p>之前的文档提示（零提示）：</p><img src="https://image-1251917893.file.myqcloud.com/next-svr/images/2025/12/own_mike_W8K7hj8S3CAxB45P.png" width="700"><p>现在的文档提示：</p><img src="https://image-1251917893.file.myqcloud.com/next-svr/images/2025/12/own_mike_w8Bm8riMhyEiKWj2.png" width="700"><p>之前的类型提示：</p><img src="https://image-1251917893.file.myqcloud.com/next-svr/images/2025/12/own_mike_bYyH6erHCnXzsCGx.png" width="700"><p>现在的类型提示：</p><img src="https://image-1251917893.file.myqcloud.com/next-svr/images/2025/12/own_mike_cpHB7tiwhr87GPXF.png" width="700"><hr><p>2025.12.23 更新</p><hr><h2 id="_7-新的依赖关系" tabindex="-1">7. 新的依赖关系 <a class="header-anchor" href="#_7-新的依赖关系" aria-label="Permalink to &quot;7. 新的依赖关系&quot;">​</a></h2><p>新增了 <code>share</code>、<code>weixin</code> 两个子包，它们功能相对独立，依赖关系清晰。</p><p>目前的依赖关系：</p>`,32)),(e(),n(d,null,{default:i(()=>[o(l,{id:"mermaid-538",class:"mermaid my-mermaid-class",graph:"graph%20TD%0AbusinessModule%20--%3E%20middle%0Amiddle%20--%3E%20base%0A%0Asubgraph%20base%5B%20%5D%0Atools%20-.-%20config%20-.-%20network%20-.-%20game-config%20-.-%20aegis%0Aend%0A%0Asubgraph%20businessModule%5B%20%5D%0Abusiness%20-.-%20netbar%0Aend%0A%0Asubgraph%20middle%5B%20%5D%0Alocation%20-.-%20report%20-.-%20login%20-.-%20pixui%20-.-%20abtest%20-.-%20jsapi%20-.-%20use%20-.-%20share%20-.-%20weixin%0Aend%0A%0AlinkStyle%202%2C3%2C4%2C5%2C6%2C7%2C8%2C9%2C10%2C11%2C12%2C13%2C14%20stroke-width%3A0px%0A"})]),fallback:i(()=>s[5]||(s[5]=[t(" Loading... ")])),_:1})),s[18]||(s[18]=a("p",null,"内部模块实际依赖关系：",-1)),(e(),n(d,null,{default:i(()=>[o(l,{id:"mermaid-542",class:"mermaid my-mermaid-class",graph:"graph%20TD%0A%25%25%20widget%20--%3E%20network%0A%25%25%20widget%20--%3E%20tools%0A%25%25%20widget%20--%3E%20aegis%0A%25%25%20widget%20--%3E%20business%0Aweixin%20--%3E%20network%0Aweixin%20--%3E%20tools%0A%25%25%20vue%20--%3E%20business%0A%25%25%20vue%20--%3E%20tools%0A%25%25%20vue%20--%3E%20report%0A%25%25%20vue%20--%3E%20aegis%0A%25%25%20vue%20--%3E%20widget%0A%25%25%20vue%20--%3E%20config%0A%25%25%20vue%20--%3E%20share%0A%25%25%20vue%20--%3E%20weixin%0Ause%20--%3E%20tools%0A%25%25%20tools%20--%3E%20weixin%0A%25%25%20tools%20--%3E%20game-config%0Ashare%20--%3E%20tools%0Ashare%20--%3E%20aegis%0Areport%20--%3E%20tools%0Areport%20--%3E%20network%0Areport%20--%3E%20config%0Apixui%20--%3E%20network%0Apixui%20--%3E%20config%0Anetbar%20--%3E%20tools%0Alogin%20--%3E%20tools%0Alogin%20--%3E%20report%0Alogin%20--%3E%20config%0Alogin%20--%3E%20network%0Alocation%20--%3E%20tools%0Alocation%20--%3E%20weixin%0Alocation%20--%3E%20network%0Ajsapi%20--%3E%20tools%0A%25%25%20config%20--%3E%20game-config%0Aconfig%20--%3E%20tools%0A%25%25%20config%20--%3E%20vue%0Abusiness%20--%3E%20report%0Abusiness%20--%3E%20tools%0Abusiness%20--%3E%20config%0Abusiness%20--%3E%20aegis%0Abusiness%20--%3E%20location%0A%25%25%20business%20--%3E%20widget%0Abusiness%20--%3E%20share%0Abusiness%20--%3E%20network%0Abusiness%20--%3E%20login%0Aaegis%20--%3E%20tools%0Aabtest%20--%3E%20tools%0Aabtest%20--%3E%20network%0Aabtest%20--%3E%20aegis%0A%0A%0Asubgraph%20base%5B%20%5D%0Atools%0Aconfig%0Anetwork%0Agame-config%0Aaegis%0Aend%0A%0Asubgraph%20businessModule%5B%20%5D%0Abusiness%0Anetbar%0Aend%0A%0Asubgraph%20middle%5B%20%5D%0Alocation%0Areport%0Alogin%0Apixui%0Aabtest%0Ajsapi%0Ause%0Ashare%0Aweixin%0Aend%0A%0A"})]),fallback:i(()=>s[6]||(s[6]=[t(" Loading... ")])),_:1})),s[19]||(s[19]=p(`<ol><li>总体三层结构，基础、业务中间层、业务上层</li><li>无反向依赖</li><li>独立的 <code>types</code> 已移除，放到对应的包之中</li></ol><hr><p>2025.12.31 更新</p><hr><h2 id="_8-network-v2" tabindex="-1">8. network-v2 <a class="header-anchor" href="#_8-network-v2" aria-label="Permalink to &quot;8. network-v2&quot;">​</a></h2><p>参见 <a href="https://iwiki.woa.com/p/4017005417" target="_blank" rel="noreferrer">https://iwiki.woa.com/p/4017005417</a></p><h2 id="_9-share-v2" tabindex="-1">9. share-v2 <a class="header-anchor" href="#_9-share-v2" aria-label="Permalink to &quot;9. share-v2&quot;">​</a></h2><p>参见 <a href="https://iwiki.woa.com/p/4017017184" target="_blank" rel="noreferrer">https://iwiki.woa.com/p/4017017184</a></p><h2 id="_10-参数缩减" tabindex="-1">10. 参数缩减 <a class="header-anchor" href="#_10-参数缩减" aria-label="Permalink to &quot;10. 参数缩减&quot;">​</a></h2><p>部分函数的参数个数多于3个，不利于维护和使用。</p><p>新增工具方法 <code>getParameters</code>，可同时支持对象参数和分散参数。好处是保持渐进升级，不影响业务。使用示例如下：</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { getParameters, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> OverloadedFn, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ImplementationArgs } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@tencent/pmd-tools/lib/parameter&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ShowTipsDialogParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  content</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  pc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> boolean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  title</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  buttonText</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  clickCallBack</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> showTipsDialogKeys</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;content&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;pc&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;title&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;buttonText&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;clickCallBack&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ShowTipsDialogKeys</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> showTipsDialogKeys;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Dialog.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">showTipsDialog</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ImplementationArgs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ShowTipsDialogParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ShowTipsDialogKeys</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    content</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    pc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    title</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;温馨提示&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    buttonText</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;我知道了&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    clickCallBack</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getParameters</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ShowTipsDialogParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;(showTipsDialogKeys, args);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ...</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 其他逻辑</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="_11-附录" tabindex="-1">11. 附录 <a class="header-anchor" href="#_11-附录" aria-label="Permalink to &quot;11. 附录&quot;">​</a></h2><h3 id="_11-1-版本更新策略" tabindex="-1">11.1. 版本更新策略 <a class="header-anchor" href="#_11-1-版本更新策略" aria-label="Permalink to &quot;11.1. 版本更新策略&quot;">​</a></h3><p>预发布即 <code>versionType</code> 为 <code>alpha/beta/rc</code></p><p>下图 <code>type</code> 即为 <code>versionType</code></p>`,16)),(e(),n(d,null,{default:i(()=>[o(l,{id:"mermaid-599",class:"mermaid my-mermaid-class",graph:"graph%20TD%0A%20%20start%5B%E8%8E%B7%E5%8F%96%E4%B8%8B%E4%B8%80%E7%89%88%E6%9C%AC%5D%20--%3E%20isPrerelease%7Btype%20%E4%B8%BA%3Cbr%2F%3E%E9%A2%84%E5%8F%91%E5%B8%83%7D%0A%20%20isPrerelease%20--%E6%98%AF--%3E%20isPrereleaseVersionExisted%7B%E5%B7%B2%E5%AD%98%E5%9C%A8%E7%9B%B8%E5%90%8C%E7%B1%BB%E5%9E%8B%3Cbr%2F%3E%E9%A2%84%E5%8F%91%E5%B8%83%E7%89%88%E6%9C%AC%7D%0A%20%20isPrerelease%20--%E5%90%A6--%3E%20releaseVersion%5B%22inc(latest%2C%20type)%22%5D%0A%20%20isPrereleaseVersionExisted%20--%E6%98%AF--%3E%20isSmallThanLatest%7Blatest%20%E5%A4%A7%E4%BA%8E%3Cbr%2F%3E%E4%B9%8B%E5%89%8D%E9%A2%84%E5%8F%91%E5%B8%83%E7%89%88%E6%9C%AC%7D%0A%20%20isSmallThanLatest%20--%E6%98%AF--%3E%20getNextVersion%5B%22inc(latest%2C%20'prepatch'%2C%20type)%22%5D%0A%20%20isSmallThanLatest%20--%E5%90%A6--%3E%20getNextVersion2%5B%22inc(old%2C%20'prerelease'%2C%20type)%22%5D%0A%20%20isPrereleaseVersionExisted%20--%E5%90%A6--%3E%20getNextVersion3%5B%22inc(latest%2C'prerelease'%2Ctype)%22%5D%0A"})]),fallback:i(()=>s[7]||(s[7]=[t(" Loading... ")])),_:1})),s[20]||(s[20]=a("h3",{id:"_11-2-版本发布流程",tabindex:"-1"},[t("11.2. 版本发布流程 "),a("a",{class:"header-anchor",href:"#_11-2-版本发布流程","aria-label":'Permalink to "11.2. 版本发布流程"'},"​")],-1)),(e(),n(d,null,{default:i(()=>[o(l,{id:"mermaid-603",class:"mermaid my-mermaid-class",graph:"graph%20LR%0A%20%20build%5BBuild%5D%20--%3E%20bump%5BBump%20Version%5D%0A%20%20bump%20--%3E%20changelog%5BChange%20Log%5D%0A%20%20changelog%20--%3E%20commit%5BCommit%5D%0A%20%20commit%20--%3E%20tag%5BTag%5D%0A%20%20tag%20--%3E%20publish%5BPublish%5D%0A%20%20publish%20--%3E%20message%5BMessage%5D%0A"})]),fallback:i(()=>s[8]||(s[8]=[t(" Loading... ")])),_:1})),s[21]||(s[21]=p('<h3 id="_11-3-版本说明" tabindex="-1">11.3. 版本说明 <a class="header-anchor" href="#_11-3-版本说明" aria-label="Permalink to &quot;11.3. 版本说明&quot;">​</a></h3><table tabindex="0"><thead><tr><th>版本</th><th>发布分支</th><th>是否可以发布现网</th><th>用途</th></tr></thead><tbody><tr><td>alpha</td><td>非 master</td><td>❌</td><td>新功能、缺陷修复</td></tr><tr><td>beta</td><td>非 master</td><td>✅</td><td>验证新功能、缺陷修复，以及大改动在某一项目上试跑一段时间</td></tr><tr><td>patch</td><td>master</td><td>✅</td><td>长期稳定版本</td></tr></tbody></table>',2))])}const w=r(E,[["render",A]]);export{F as __pageData,w as default};
