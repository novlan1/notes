import{_ as i,c as t,o as a,a2 as e}from"./chunks/framework.CriqKoQt.js";const k=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"docs/2026上/tdesign-uniapp中的图标瘦身.md","filePath":"docs/2026上/tdesign-uniapp中的图标瘦身.md","lastUpdated":1771659433000}'),n={name:"docs/2026上/tdesign-uniapp中的图标瘦身.md"};function d(l,s,h,p,o,r){return a(),t("div",null,s[0]||(s[0]=[e(`<h2 id="_1-背景" tabindex="-1">1. 背景 <a class="header-anchor" href="#_1-背景" aria-label="Permalink to &quot;1. 背景&quot;">​</a></h2><p>随着 <a href="https://tdesign.tencent.com/icons/" target="_blank" rel="noreferrer">tdesign-icons</a> 图标的不断丰富，<a href="https://github.com/Tencent/tdesign-miniprogram/blob/develop/packages/uniapp-components/common/style/icons.less" target="_blank" rel="noreferrer">@tdesign/uniapp</a> 包的图标文件大小也不断变大。但是普通业务一般并不需要同时使用这么多图标，并且小程序等场景图标只能使用 <code>iconfont</code> 等，不支持动态加载，所以需要一种方式减包、瘦身。</p><h2 id="_2-解决方案" tabindex="-1">2. 解决方案 <a class="header-anchor" href="#_2-解决方案" aria-label="Permalink to &quot;2. 解决方案&quot;">​</a></h2><p>不同于原生小程序，<a href="https://tdesign.tencent.com/uniapp/overview" target="_blank" rel="noreferrer">@tdesign/uniapp</a> 在上传前有构建一步，可以利用插件来减包。</p><p>可以使用<a href="https://www.npmjs.com/package/@novlan/postcss-plugin-remove-selector?activeTab=readme" target="_blank" rel="noreferrer">postcss-plugin-remove-selector</a> 来在构建时进行无用图标的删减。</p><p>点此查看<a href="https://www.npmjs.com/package/@novlan/postcss-plugin-remove-selector?activeTab=readme" target="_blank" rel="noreferrer">文档</a>。</p><h2 id="_3-如何使用" tabindex="-1">3. 如何使用 <a class="header-anchor" href="#_3-如何使用" aria-label="Permalink to &quot;3. 如何使用&quot;">​</a></h2><p>安装</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> @novlan/postcss-plugin-remove-selector</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -D</span></span></code></pre></div><h3 id="_3-1-简化模式-推荐" tabindex="-1">3.1. 简化模式（推荐） <a class="header-anchor" href="#_3-1-简化模式-推荐" aria-label="Permalink to &quot;3.1. 简化模式（推荐）&quot;">​</a></h3><p>通过 <code>mode</code> 指定预设，只需关注 <code>used</code>/<code>unused</code>，无需手动配置 <code>file</code> 和 <code>selectorPattern</code>：</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { defineConfig } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vite&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { postcssPluginRemoveSelector } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@novlan/postcss-plugin-remove-selector&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  css: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    postcss: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      plugins: [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        postcssPluginRemoveSelector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          mode: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;tdesign&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          used: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;home&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;chat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;user&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;add&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;search&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;close&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      ],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><p>使用 <code>customUsed</code> / <code>customUnused</code> 可在预设基础上增量追加，不会覆盖预设中已有的列表：</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">postcssPluginRemoveSelector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  mode: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;tdesign&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 在 tdesign 预设默认的 used 列表上，额外追加 &#39;star&#39; 和 &#39;heart&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  customUsed: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;star&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;heart&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 从结果中额外移除 &#39;loading&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  customUnused: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;loading&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><h3 id="_3-2-标准模式" tabindex="-1">3.2. 标准模式 <a class="header-anchor" href="#_3-2-标准模式" aria-label="Permalink to &quot;3.2. 标准模式&quot;">​</a></h3><p>通过 <code>list</code> 数组传入完整配置，适用于需要匹配多个文件的复杂场景：</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { defineConfig } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vite&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { postcssPluginRemoveSelector } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@novlan/postcss-plugin-remove-selector&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  TDESIGN_ICON_REMOVE_SELECTOR</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@novlan/postcss-plugin-remove-selector/lib/tdesign-uniapp-icon&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  css: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    postcss: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      plugins: [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">postcssPluginRemoveSelector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TDESIGN_ICON_REMOVE_SELECTOR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><h2 id="_4-类型" tabindex="-1">4. 类型 <a class="header-anchor" href="#_4-类型" aria-label="Permalink to &quot;4. 类型&quot;">​</a></h2><p>插件支持两种配置方式，传入 <code>SimpleOptions</code>（简化模式）或 <code>Options</code>（标准模式）均可。</p><h3 id="_4-1-simpleoptions-简化模式" tabindex="-1">4.1. SimpleOptions（简化模式） <a class="header-anchor" href="#_4-1-simpleoptions-简化模式" aria-label="Permalink to &quot;4.1. SimpleOptions（简化模式）&quot;">​</a></h3><table tabindex="0"><thead><tr><th>属性</th><th>类型</th><th>是否必填</th><th>说明</th></tr></thead><tbody><tr><td><code>mode</code></td><td><code>&#39;tdesign&#39;</code></td><td>否</td><td>预设模式，设置后自动使用对应的 <code>file</code> 和 <code>selectorPattern</code> 默认值</td></tr><tr><td><code>file</code></td><td><code>RegExp | string</code></td><td>否</td><td>文件匹配规则。使用 <code>mode</code> 时可省略</td></tr><tr><td><code>used</code></td><td><code>string[]</code></td><td>否</td><td>正在使用的图标名称列表，这些图标会被保留</td></tr><tr><td><code>unused</code></td><td><code>string[]</code></td><td>否</td><td>未使用的图标名称列表，这些图标会被移除</td></tr><tr><td><code>customUsed</code></td><td><code>string[]</code></td><td>否</td><td>增量追加到 <code>used</code> 列表（不覆盖预设或已有的 <code>used</code>）</td></tr><tr><td><code>customUnused</code></td><td><code>string[]</code></td><td>否</td><td>增量追加到 <code>unused</code> 列表（不覆盖预设或已有的 <code>unused</code>）</td></tr><tr><td><code>selectorPattern</code></td><td><code>RegExp</code></td><td>否</td><td>选择器匹配模式。使用 <code>mode</code> 时可省略</td></tr><tr><td><code>debug</code></td><td><code>boolean</code></td><td>否</td><td>是否开启调试模式</td></tr></tbody></table><blockquote><p><code>mode</code> 和 <code>file</code> 至少需要指定一个。当 <code>mode</code> 和 <code>file</code>/<code>selectorPattern</code> 同时指定时，<code>file</code>/<code>selectorPattern</code> 优先。</p></blockquote><h3 id="_4-2-options-标准模式" tabindex="-1">4.2. Options（标准模式） <a class="header-anchor" href="#_4-2-options-标准模式" aria-label="Permalink to &quot;4.2. Options（标准模式）&quot;">​</a></h3><table tabindex="0"><thead><tr><th>属性</th><th>类型</th><th>是否必填</th><th>说明</th></tr></thead><tbody><tr><td><code>list</code></td><td><code>FileConfig[]</code></td><td>是</td><td>配置列表</td></tr><tr><td><code>debug</code></td><td><code>boolean</code></td><td>否</td><td>是否开启调试模式</td></tr></tbody></table><h3 id="_4-3-fileconfig" tabindex="-1">4.3. FileConfig <a class="header-anchor" href="#_4-3-fileconfig" aria-label="Permalink to &quot;4.3. FileConfig&quot;">​</a></h3><table tabindex="0"><thead><tr><th>属性</th><th>类型</th><th>是否必填</th><th>说明</th></tr></thead><tbody><tr><td><code>file</code></td><td><code>RegExp | string</code></td><td>是</td><td>文件匹配规则，可以是字符串或正则表达式</td></tr><tr><td><code>used</code></td><td><code>string[]</code></td><td>否</td><td>正在使用的图标名称列表，这些图标会被保留</td></tr><tr><td><code>unused</code></td><td><code>string[]</code></td><td>否</td><td>未使用的图标名称列表，这些图标会被移除</td></tr><tr><td><code>customUsed</code></td><td><code>string[]</code></td><td>否</td><td>增量追加到 <code>used</code> 列表（不覆盖已有的 <code>used</code>）</td></tr><tr><td><code>customUnused</code></td><td><code>string[]</code></td><td>否</td><td>增量追加到 <code>unused</code> 列表（不覆盖已有的 <code>unused</code>）</td></tr><tr><td><code>selectorPattern</code></td><td><code>RegExp</code></td><td>否</td><td>选择器匹配模式，只处理匹配该模式的选择器</td></tr></tbody></table><h3 id="_4-4-内置预设" tabindex="-1">4.4. 内置预设 <a class="header-anchor" href="#_4-4-内置预设" aria-label="Permalink to &quot;4.4. 内置预设&quot;">​</a></h3><table tabindex="0"><thead><tr><th>mode</th><th>说明</th><th>默认 file</th><th>默认 selectorPattern</th></tr></thead><tbody><tr><td><code>tdesign</code></td><td>TDesign UniApp 图标减包</td><td><code>/[@/]tdesign[/]uniapp[/]dist[/]icon[/]icon\\.[css|vue]/</code></td><td><code>/^\\.t-icon-[\\w-]+:before$/</code></td></tr></tbody></table><h2 id="_5-文档" tabindex="-1">5. 文档 <a class="header-anchor" href="#_5-文档" aria-label="Permalink to &quot;5. 文档&quot;">​</a></h2><ol><li><a href="https://www.npmjs.com/package/@novlan/postcss-plugin-remove-selector?activeTab=readme" target="_blank" rel="noreferrer">文档</a></li><li><a href="https://novlan1.github.io/plugins/changelog/postcss-plugin-remove-selector.html" target="_blank" rel="noreferrer">更新日志</a></li><li><a href="https://github.com/TDesignOteam/tdesign-uniapp-starter" target="_blank" rel="noreferrer">示例项目</a></li></ol><h2 id="_6-效果" tabindex="-1">6. 效果 <a class="header-anchor" href="#_6-效果" aria-label="Permalink to &quot;6. 效果&quot;">​</a></h2><p>以 <a href="https://github.com/TDesignOteam/tdesign-uniapp-starter" target="_blank" rel="noreferrer">tdesign-uniapp-starter</a> 为例，使用此插件，可使小程序大小减少<code>138KB</code>，约<code>95.8%</code>。</p><p>使用前：</p><img src="https://cdn.uwayfly.com/article/2026/2/own_mike_4w2yXDz3tMcaJ2nx.png" width="900"><p>使用后：</p><img src="https://cdn.uwayfly.com/article/2026/2/own_mike_dsdB5TmAaedmkPr5.png" width="900"><h2 id="_7-faq" tabindex="-1">7. FAQ <a class="header-anchor" href="#_7-faq" aria-label="Permalink to &quot;7. FAQ&quot;">​</a></h2><ol><li>如何快速拿到业务中使用的图标列表</li></ol><p>可以用下面的命令获取：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -rho</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;icon=&quot;[^&quot;]*&quot;\\|left-icon=&quot;[^&quot;]*&quot;\\|right-icon=&quot;[^&quot;]*&quot;\\|name=&quot;[^&quot;]*&quot;&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> src</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --include=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;*.vue&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sort</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> uniq</span></span></code></pre></div><p>不过这个可能会漏掉一些动态图标，需要手动检查。</p>`,41)]))}const E=i(n,[["render",d]]);export{k as __pageData,E as default};
