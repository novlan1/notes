## 1. 开始

记录下业务被门神拦截的问题。

## 2. 问题暴露

测试同学发现页面打不开，被重定向到 501 页面。

<img src="https://mike-1255355338.cos.ap-guangzhou.myqcloud.com/article/2025/6/own_mike_beXrP2MsbMdTek58.png" width="500">

## 3. 问题排查

问了一圈，得到原因是门神拦截的，具体是：

- 洞悉平台扫描后台接口，种下了脏 `cookie`
- 门神平台同样扫了后台接口，检测到脏 `cookie`，重定向到 501

脏 `cookie` 举例：

```
${url:UTF-8:http://tst2.qq.com/cmd_inject/310d5a77b52e0d65752d5de079e97e05}
```

洞悉种这个是为了检测页面是否有 CSRF 漏洞。门神检测到 `cookie` 里有不合法的字符，如 `${}<>`等就关键字拦截请求并重定向到 501。

比较奇葩的是这一拦截没有官方文档，全靠口口相传。

## 4. 问题解决

前端尝试发送请求前清理脏数据，发现并不能生效。最后解决办法是后台过滤，遇到这种`cookie`，拦截、过滤，不入库、不下发。
